import{j as e,az as f,r as p,d as R,A as M,aI as O,aJ as P,aK as L,aL as w,aM as _,aN as H,aO as F,aP as V,I as j,a as B,U as W,F as k,aQ as J,h as D,S as U,N as G}from"./index-3pZLK3h4.js";function Y({data:a=[],height:l=200,showLabels:s=!0,animated:t=!0}){const[r,o]=p.useState(!t),d=p.useRef(null);if(p.useEffect(()=>{if(!t)return;const c=setTimeout(()=>o(!0),100);return()=>clearTimeout(c)},[t]),a.length===0)return null;const u=Math.max(...a.map(c=>c.value),1);return e.jsxs("div",{className:"chart-container bar-chart",ref:d,children:[e.jsx("div",{className:"bar-chart-bars",style:{height:l},children:a.map((c,m)=>{const v=c.value/u*100;return e.jsx("div",{className:"bar-chart-bar-wrapper",children:e.jsx("div",{className:f("bar-chart-bar",c.color||"blue"),style:{height:r?`${v}%`:"0%",transitionDelay:`${m*50}ms`},title:`${c.label}: ${c.value}`,children:s&&c.value>0&&e.jsx("span",{className:"bar-chart-value",children:c.value})})},m)})}),e.jsx("div",{className:"bar-chart-labels",children:a.map((c,m)=>e.jsx("div",{className:"bar-chart-label",title:c.label,children:c.label},m))})]})}function $({data:a=[],height:l=200,showDots:s=!0,showArea:t=!0}){const[r,o]=p.useState(!1);if(p.useEffect(()=>{const n=setTimeout(()=>o(!0),100);return()=>clearTimeout(n)},[]),a.length===0)return null;const d=Math.max(...a.map(n=>n.value),1),u=20,c=100,m=100,v=a.map((n,x)=>{const E=u+x/(a.length-1||1)*(c-2*u),h=m-u-n.value/d*(m-2*u);return{x:E,y:h,value:n.value,label:n.label}}),i=v.map((n,x)=>`${x===0?"M":"L"} ${n.x} ${n.y}`).join(" "),g=`${i} L ${v[v.length-1].x} ${m-u} L ${u} ${m-u} Z`;return e.jsxs("div",{className:"chart-container line-chart",style:{height:l},children:[e.jsxs("svg",{viewBox:`0 0 ${c} ${m}`,preserveAspectRatio:"none",children:[[0,25,50,75,100].map(n=>{const x=m-u-n/100*(m-2*u);return e.jsx("line",{x1:u,y1:x,x2:c-u,y2:x,className:"line-chart-grid"},n)}),t&&e.jsx("path",{d:g,className:f("line-chart-area",r&&"visible")}),e.jsx("path",{d:i,className:f("line-chart-line",r&&"visible")}),s&&v.map((n,x)=>e.jsx("circle",{cx:n.x,cy:n.y,r:"2",className:f("line-chart-dot",r&&"visible"),style:{transitionDelay:`${x*50}ms`},children:e.jsx("title",{children:`${n.label}: ${n.value}`})},x))]}),e.jsx("div",{className:"line-chart-labels",children:a.map((n,x)=>e.jsx("div",{className:"line-chart-label",children:n.label},x))})]})}function q({data:a=[],size:l=160,thickness:s=20,showLegend:t=!0}){const[r,o]=p.useState(!1);if(p.useEffect(()=>{const i=setTimeout(()=>o(!0),100);return()=>clearTimeout(i)},[]),a.length===0)return null;const d=a.reduce((i,g)=>i+g.value,0),u=l/2-s/2,c=2*Math.PI*u;let m=0;const v=a.map(i=>{const g=d>0?i.value/d:0,n=g*c,x=-m;return m+=n,{...i,percent:g,dashArray:`${n} ${c}`,dashOffset:x}});return e.jsxs("div",{className:"chart-container donut-chart",children:[e.jsx("div",{className:"donut-chart-wrapper",children:e.jsxs("svg",{width:l,height:l,viewBox:`0 0 ${l} ${l}`,children:[e.jsx("circle",{cx:l/2,cy:l/2,r:u,className:"donut-chart-bg",strokeWidth:s}),v.map((i,g)=>e.jsx("circle",{cx:l/2,cy:l/2,r:u,className:f("donut-chart-segment",i.color||"blue",r&&"visible"),strokeWidth:s,strokeDasharray:i.dashArray,strokeDashoffset:i.dashOffset,transform:`rotate(-90 ${l/2} ${l/2})`,style:{transitionDelay:`${g*100}ms`},children:e.jsx("title",{children:`${i.label}: ${i.value} (${Math.round(i.percent*100)}%)`})},g)),e.jsxs("text",{x:l/2,y:l/2,className:"donut-chart-center",children:[e.jsx("tspan",{x:l/2,dy:"-0.2em",className:"donut-chart-total",children:d}),e.jsx("tspan",{x:l/2,dy:"1.4em",className:"donut-chart-label",children:"Total"})]})]})}),t&&e.jsx("div",{className:"donut-chart-legend",children:v.map((i,g)=>e.jsxs("div",{className:"donut-chart-legend-item",children:[e.jsx("span",{className:f("donut-chart-legend-dot",i.color||"blue")}),e.jsx("span",{className:"donut-chart-legend-label",children:i.label}),e.jsxs("span",{className:"donut-chart-legend-value",children:[i.value," (",Math.round(i.percent*100),"%)"]})]},g))})]})}function K({title:a,value:l,change:s,changeType:t="neutral",sparklineData:r=[],icon:o}){const d=t==="positive"?"▲":t==="negative"?"▼":"•";return e.jsxs("div",{className:"stat-card",children:[e.jsxs("div",{className:"stat-card-header",children:[o&&e.jsx("span",{className:"stat-card-icon",children:o}),e.jsx("span",{className:"stat-card-title",children:a})]}),e.jsx("div",{className:"stat-card-value",children:l}),s!==void 0&&e.jsxs("div",{className:f("stat-card-change",t),children:[e.jsx("span",{className:"stat-card-change-icon",children:d}),e.jsx("span",{children:s})]}),r.length>0&&e.jsx("div",{className:"stat-card-sparkline",children:e.jsx($,{data:r,height:40,showDots:!1,showArea:!1})})]})}function z({value:a,max:l=100,label:s,color:t="blue",showValue:r=!0,size:o="md"}){const d=Math.min(100,Math.max(0,a/l*100));return e.jsxs("div",{className:f("progress-bar",o),children:[s&&e.jsx("span",{className:"progress-bar-label",children:s}),e.jsx("div",{className:"progress-bar-track",children:e.jsx("div",{className:f("progress-bar-fill",t),style:{width:`${d}%`}})}),r&&e.jsxs("span",{className:"progress-bar-value",children:[Math.round(d),"%"]})]})}const C={CREATE:{color:"green",icon:V,label:"Created"},UPDATE:{color:"blue",icon:F,label:"Updated"},DELETE:{color:"red",icon:H,label:"Deleted"},STATUS_CHANGE:{color:"orange",icon:_,label:"Status Changed"},COMMENT:{color:"purple",icon:w,label:"Commented"},APPROVAL:{color:"green",icon:L,label:"Approved"},REJECTION:{color:"red",icon:P,label:"Rejected"},INTERVIEW:{color:"blue",icon:O,label:"Interview"},HIRE:{color:"green",icon:M,label:"Hired"}};function Q(a){const l=new Date(a),s=new Date,t=s-l,r=Math.floor(t/6e4),o=Math.floor(t/36e5),d=Math.floor(t/864e5);return r<1?"Just now":r<60?`${r} min ago`:o<24?`${o} hours ago`:d<7?`${d} days ago`:l.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:l.getFullYear()!==s.getFullYear()?"numeric":void 0})}function X({activity:a,isLast:l}){const s=C[a.type]||C.UPDATE,t=s.icon||R;return e.jsxs("div",{className:f("timeline-item",l&&"is-last"),children:[e.jsxs("div",{className:"timeline-marker-container",children:[e.jsx("div",{className:f("timeline-marker",s.color),children:e.jsx(t,{size:14})}),!l&&e.jsx("div",{className:"timeline-line"})]}),e.jsxs("div",{className:"timeline-content",children:[e.jsxs("div",{className:"timeline-header",children:[e.jsx("span",{className:"timeline-title",children:a.title||s.label}),e.jsx("span",{className:"timeline-time",children:Q(a.timestamp)})]}),a.description&&e.jsx("p",{className:"timeline-description",children:a.description}),a.metadata&&e.jsxs("div",{className:"timeline-metadata",children:[a.metadata.from&&a.metadata.to&&e.jsxs("div",{className:"timeline-change",children:[e.jsx("span",{className:"timeline-change-from",children:a.metadata.from}),e.jsx("span",{className:"timeline-change-arrow","aria-hidden":"true",children:e.jsx(_,{size:14})}),e.jsx("span",{className:"timeline-change-to",children:a.metadata.to})]}),a.metadata.actor&&e.jsxs("span",{className:"timeline-actor",children:["by ",a.metadata.actor]})]}),a.actions&&e.jsx("div",{className:"timeline-actions",children:a.actions.map((r,o)=>e.jsx("button",{className:"timeline-action-btn",onClick:r.onClick,children:r.label},o))})]})]})}function Z({activities:a=[],maxItems:l,title:s="Recent Activity",emptyMessage:t="No activity yet"}){const r=l?a.slice(0,l):a;return e.jsxs("div",{className:"activity-timeline",children:[s&&e.jsx("h3",{className:"timeline-title-header",children:s}),r.length===0?e.jsxs("div",{className:"timeline-empty",children:[e.jsx("span",{className:"timeline-empty-icon","aria-hidden":"true",children:e.jsx(R,{size:24})}),e.jsx("p",{children:t})]}):e.jsx("div",{className:"timeline-list",children:r.map((o,d)=>e.jsx(X,{activity:o,isLast:d===r.length-1},o.id||d))}),l&&a.length>l&&e.jsx("div",{className:"timeline-footer",children:e.jsxs("button",{className:"timeline-view-all",children:["View all activity (",a.length,")"]})})]})}async function ee(a){return j("CANDIDATE_PIPELINE_STATS",{},a)}async function ae(a,l={}){return j("RECENT_ACTIVITY",{limit:l.limit||20,entityType:l.entityType||null},a)}async function le(a,l={}){return j("HIRING_TRENDS",{period:l.period||"monthly",dateFrom:l.dateFrom||null,dateTo:l.dateTo||null},a)}async function te(a){return j("SLA_COMPLIANCE_METRICS",{},a)}async function se(a,l={}){return j("SOURCE_DISTRIBUTION",{dateFrom:l.dateFrom||null,dateTo:l.dateTo||null},a)}async function re(a){return j("DASHBOARD_METRICS",{},a)}const ne=[{label:"HR Review",value:45,color:"blue"},{label:"Precall",value:32,color:"orange"},{label:"Tech Interview",value:28,color:"purple"},{label:"Final",value:15,color:"green"},{label:"Joining",value:8,color:"blue"}],ie=[{label:"Jan",value:12},{label:"Feb",value:19},{label:"Mar",value:15},{label:"Apr",value:25},{label:"May",value:22},{label:"Jun",value:30},{label:"Jul",value:28}],ce=[{label:"Job Portals",value:45,color:"blue"},{label:"Referrals",value:30,color:"green"},{label:"Walk-ins",value:15,color:"orange"},{label:"Others",value:10,color:"gray"}],oe=[{id:"1",type:"HIRE",title:"Candidate hired",description:"Rahul Sharma joined as Software Developer",timestamp:new Date(Date.now()-2*60*60*1e3).toISOString(),metadata:{actor:"HR Admin"}}],de=[{label:"HR Review",value:85,max:100},{label:"Precall",value:92,max:100},{label:"Tech Interview",value:78,max:100},{label:"Final Interview",value:95,max:100},{label:"Joining",value:88,max:100}],ue={SHORTLISTING:"blue",OWNER_APPROVAL:"purple",WALKIN:"orange",FINAL_DECISION:"green",HR_REVIEW:"blue",PRECALL:"orange",PRE_INTERVIEW:"orange",INPERSON_TECH:"purple",EA_TECH:"purple",FINAL_INTERVIEW:"green",FINAL_HOLD:"orange",JOINING:"blue",PROBATION:"blue",HIRED:"green",REJECTED:"red",OTHER:"gray"};function he(a=[]){return Array.isArray(a)?a.map(l=>({label:String(l.label||l.stage||""),value:Number(l.count||0),color:ue[String(l.stage||"").toUpperCase()]||"gray"})):[]}function me(a=[]){return Array.isArray(a)?a.map(l=>({label:String(l.label||l.source||"Other"),value:Number(l.count||0),color:String(l.color||"gray")})):[]}function pe(a=[]){return Array.isArray(a)?a.map(l=>({label:String(l.period||""),value:Number(l.count||0)})):[]}function xe(a=[]){return Array.isArray(a)?a.map(l=>({label:String(l.label||l.stage||""),value:Number(l.compliance||0),max:100})):[]}function ve(){const{token:a}=B(),[l,s]=p.useState(!0),[t,r]=p.useState({totalCandidates:0,activeRequirements:0,pendingApprovals:0,thisMonthHires:0}),[o,d]=p.useState(ne),[u,c]=p.useState(ie),[m,v]=p.useState(ce),[i,g]=p.useState(oe),[n,x]=p.useState(de),E=p.useMemo(()=>[{title:"Total Candidates",value:t.totalCandidates,change:void 0,changeType:"neutral",icon:e.jsx(W,{size:18})},{title:"Active Requirements",value:t.activeRequirements,change:void 0,changeType:"neutral",icon:e.jsx(k,{size:18})},{title:"Pending Approvals",value:t.pendingApprovals,change:void 0,changeType:"neutral",icon:e.jsx(J,{size:18})},{title:"This Month Hires",value:t.thisMonthHires,change:void 0,changeType:"neutral",icon:e.jsx(M,{size:18})}],[t]);return p.useEffect(()=>{if(!a)return;let h=!1;async function S(){s(!0);try{const[b,N,y,A,T,I]=await Promise.all([re(a),ee(a),se(a),le(a,{period:"monthly"}),te(a),ae(a,{limit:25})]);if(h)return;b&&r(b),N!=null&&N.stages&&d(he(N.stages)),y!=null&&y.sources&&v(me(y.sources)),A!=null&&A.trends&&c(pe(A.trends)),T!=null&&T.metrics&&x(xe(T.metrics)),I!=null&&I.activities&&g(I.activities)}catch(b){console.error("Failed to load analytics:",b),G.error("Failed to load analytics",{id:"analytics_load"})}finally{h||s(!1)}}return S(),()=>{h=!0}},[a]),l?e.jsx(D,{children:e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"60px"},children:[e.jsx(U,{}),e.jsx("p",{className:"small",style:{marginTop:"16px"},children:"Loading analytics..."})]})}):e.jsxs(D,{children:[e.jsxs("div",{className:"analytics-page",children:[e.jsxs("div",{className:"page-header",style:{marginBottom:"24px"},children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",color:"var(--gray-900)",margin:0},children:"Analytics Dashboard"}),e.jsx("p",{className:"small",children:"Real-time insights into your hiring pipeline"})]}),e.jsx("div",{className:"metric-grid",style:{marginBottom:"24px"},children:E.map(h=>e.jsx(K,{title:h.title,value:h.value,change:h.change,changeType:h.changeType,icon:h.icon},h.title))}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"24px",marginBottom:"24px"},children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"16px",color:"var(--gray-900)"},children:"Candidate Pipeline"}),e.jsx(Y,{data:o,height:220})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"16px",color:"var(--gray-900)"},children:"Source Distribution"}),e.jsx(q,{data:m,size:160,thickness:24})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px",marginBottom:"24px"},children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"16px",color:"var(--gray-900)"},children:"Hiring Trend"}),e.jsx($,{data:u,height:180})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"16px",color:"var(--gray-900)"},children:"SLA Compliance"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:n.map((h,S)=>e.jsx(z,{label:h.label,value:h.value,max:h.max,color:h.value>=90?"green":h.value>=70?"blue":"orange"},`${h.label}-${S}`))})]})]}),e.jsx("div",{className:"card",children:e.jsx(Z,{activities:i,title:"Recent Activity",maxItems:8})})]}),e.jsx("style",{children:`
        @media (max-width: 1024px) {
          .analytics-page > div[style*="grid-template-columns: 2fr 1fr"] {
            grid-template-columns: 1fr !important;
          }
          .analytics-page > div[style*="grid-template-columns: 1fr 1fr"] {
            grid-template-columns: 1fr !important;
          }
        }
      `})]})}export{ve as AnalyticsPage,ve as default};
