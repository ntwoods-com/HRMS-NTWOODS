import{a as E,r as c,j as e,A as h,S as j,n}from"./index-grL27em3.js";import{T}from"./TrainingList-BS7WbGfL.js";import{u as y,e as x}from"./training-CjQMu29P.js";import"./files-CjotXup9.js";function R(){const{token:l,me:s}=E(),t=String((s==null?void 0:s.candidateId)||"").trim(),[g,m]=c.useState(!1),[o,p]=c.useState([]),i=c.useMemo(()=>(Array.isArray(o)?o:[]).reduce((a,u)=>{const f=String((u==null?void 0:u.status)||"").toUpperCase();return a.TOTAL+=1,f==="COMPLETED"?a.COMPLETED+=1:f==="IN_PROGRESS"?a.IN_PROGRESS+=1:f==="OVERDUE"?a.OVERDUE+=1:a.PENDING+=1,a},{TOTAL:0,PENDING:0,IN_PROGRESS:0,COMPLETED:0,OVERDUE:0}),[o]);async function d(){if(!t){p([]);return}m(!0);try{const r=await x(l,{candidateId:t});p(r.items??[])}catch(r){n.error((r==null?void 0:r.message)||"Failed to load trainings"),p([])}finally{m(!1)}}return c.useEffect(()=>{d()},[t]),e.jsx(h,{children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"row",style:{alignItems:"center",flexWrap:"wrap"},children:[e.jsx("h2",{style:{margin:0},children:"My Trainings"}),e.jsx("div",{className:"spacer"}),e.jsxs("button",{className:"button",type:"button",onClick:d,disabled:g,children:[g?e.jsx(j,{size:14}):null,"Refresh"]})]}),e.jsx("div",{style:{height:10}}),e.jsxs("div",{className:"small",style:{color:"var(--gray-600)"},children:["Employee: ",e.jsx("b",{children:(s==null?void 0:s.fullName)||(s==null?void 0:s.employeeId)||(s==null?void 0:s.userId)||"-"}),s!=null&&s.jobRole?` • Role: ${s.jobRole}`:"",s!=null&&s.jobTitle?` • ${s.jobTitle}`:""]}),e.jsxs("div",{className:"small",style:{color:"var(--gray-500)",marginTop:4},children:["Employee ID: ",e.jsx("b",{children:(s==null?void 0:s.employeeId)||(s==null?void 0:s.userId)||"-"})]}),e.jsx("div",{style:{height:12}}),i.TOTAL?e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center",marginBottom:10},children:[e.jsxs("span",{className:"badge",children:["Total: ",i.TOTAL]}),e.jsxs("span",{className:"badge",style:{background:"#f59e0b",color:"#fff"},children:["Pending: ",i.PENDING]}),e.jsxs("span",{className:"badge",style:{background:"#3b82f6",color:"#fff"},children:["In-Progress: ",i.IN_PROGRESS]}),e.jsxs("span",{className:"badge",style:{background:"#22c55e",color:"#fff"},children:["Completed: ",i.COMPLETED]}),e.jsxs("span",{className:"badge",style:{background:"#ef4444",color:"#fff"},children:["Overdue: ",i.OVERDUE]})]}):null,e.jsx(T,{items:o,token:l,loading:g,canUpdate:!0,onStart:async r=>{try{await y(l,{candidate_id:t,assigned_id:r.assigned_id,op:"START",remarks:""}),n.success("Marked In-Progress"),await d()}catch(a){n.error((a==null?void 0:a.message)||"Failed")}},onComplete:async r=>{try{await y(l,{candidate_id:t,assigned_id:r.assigned_id,op:"COMPLETE",remarks:""}),n.success("Completed"),await d()}catch(a){n.error((a==null?void 0:a.message)||"Failed")}}}),t?null:e.jsx("div",{className:"small",style:{marginTop:10,color:"var(--danger)"},children:"Candidate mapping not found for this Employee ID."})]})})}export{R as EmployeeTrainingPage};
