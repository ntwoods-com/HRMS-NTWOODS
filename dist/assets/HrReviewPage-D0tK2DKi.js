import{y as se,a as os,z as ds,r as u,o as ct,B as cs,j as e,C as us,D as a,E as ut,F as hs,G as ms,H as ht,I as ps,J as gs,K as fs,L as mt}from"./index-grL27em3.js";import{v as pt}from"./scheduling-mgpGDE0C.js";import{o as xs}from"./files-CjotXup9.js";import{c as Te}from"./pii-BcFV6mqh.js";import{S as Ns}from"./SlaCountdown-DTF7N97H.js";import"./useNowTick-_9wyDYsU.js";function bs(m,{requirementId:R}){return se("JOBPOST_INIT",{requirementId:R},m)}function ys(m,{requirementId:R,portals:B}){return se("JOBPOST_SET_PORTALS",{requirementId:R,portals:B},m)}function Is(m,{requirementId:R,portalKey:B,filename:ne,mimeType:re,base64:ae}){return se("JOBPOST_UPLOAD_SCREENSHOT",{requirementId:R,portalKey:B,filename:ne,mimeType:re,base64:ae},m)}function Ss(m,{requirementId:R,portalKey:B}){return se("JOBPOST_MARK_PORTAL",{requirementId:R,portalKey:B},m)}function js(m,{requirementId:R}){return se("JOBPOST_COMPLETE",{requirementId:R},m)}const ks=[{key:"REVIEW",label:"Pending Review"},{key:"PENDING_EA",label:"Pending EA"},{key:"APPROVED",label:"Process"}];function Rs(m){const R=String(m||"").toUpperCase();return R==="APPROVED"?"PROCESS":R||"-"}function ws(){var tt,st,nt,rt,at,it,lt;const{token:m,legacyRole:R,canPortal:B,canAction:ne,canUi:re}=os(),ae=ds();function gt(t,s){const n=typeof B=="function"?B(t):null;if(n===!0||n===!1)return n;const i=String(R||"").toUpperCase();return(Array.isArray(s)?s:[]).includes(i)}function d(t,s){const n=typeof ne=="function"?ne(t):null;if(n===!0||n===!1)return n;const i=String(R||"").toUpperCase();return(Array.isArray(s)?s:[]).includes(i)}function Ne(t,s){const n=typeof re=="function"?re(t):null;if(n===!0||n===!1)return n;const i=String(R||"").toUpperCase();return(Array.isArray(s)?s:[]).includes(i)}const[S,De]=u.useState("REVIEW"),[ft,xt]=u.useState(""),[we,Le]=u.useState(!1),[A,Nt]=u.useState([]),[ie,bt]=u.useState({review:0,pendingEa:0,approved:0}),[le,be]=u.useState(""),[Pe,oe]=u.useState(""),[yt,It]=u.useState({}),[St,Oe]=u.useState(""),[jt,_e]=u.useState(""),[qe,Me]=u.useState(""),[kt,Be]=u.useState(""),[Rt,vt]=u.useState({}),[He,We]=u.useState(""),[H,V]=u.useState({open:!1,current:0,total:0,errors:[]}),[Et,Ue]=u.useState({}),[D,de]=u.useState({open:!1,requirementId:"",candidate:null}),[$e,ye]=u.useState(""),[P,W]=u.useState(""),[Ct,Ke]=u.useState({}),[Fe,ce]=u.useState({open:!1,requirementId:""}),[z,Je]=u.useState("OWNER_SEND"),[Ve,ze]=u.useState(""),[U,G]=u.useState({open:!1,current:0,total:0,errors:[]}),[At,Tt]=u.useState({}),[Dt,Ge]=u.useState({}),[wt,Lt]=u.useState({}),[Qe,Pt]=u.useState(""),[Ot,_t]=u.useState({}),[Q,Ie]=u.useState(""),Y=u.useRef({}),[ue,Ye]=u.useState({}),[qt,Xe]=u.useState(""),Ze=u.useMemo(()=>({REVIEW:ie.review,PENDING_EA:ie.pendingEa,APPROVED:ie.approved}),[ie]);u.useEffect(()=>{const t=new URLSearchParams(ae.search||""),s=String(t.get("tab")||"").toUpperCase().trim(),n=String(t.get("focus")||"").toUpperCase().trim();["REVIEW","PENDING_EA","APPROVED","ALL"].includes(s)&&s!==S&&De(s),xt(n)},[ae.search]);async function v(t=S){Le(!0);try{const s=await us(m,{tab:t}),n=s.items||[];if(Nt(n),bt(s.counts||{review:0,pendingEa:0,approved:0}),ft==="WALKIN"){const i={};n.forEach(o=>{(o.candidates||[]).filter(b=>{const E=String(b.status||"").toUpperCase();return E==="WALKIN_PENDING"||E==="WALKIN_SCHEDULED"}).length&&(i[o.requirementId]="WALKIN")}),Object.keys(i).length&&Ue(o=>({...o,...i}))}}catch(s){a.error((s==null?void 0:s.message)||"Failed to load requirements")}finally{Le(!1)}}u.useEffect(()=>{v(S)},[S]),u.useEffect(()=>{!Q&&A&&A.length&&Ie(A[0].requirementId)},[A]),u.useEffect(()=>{if(!A||A.length===0)return;const t=Y.current||{},s=A.map(i=>t[i.requirementId]).filter(Boolean);if(s.length===0)return;const n=new IntersectionObserver(i=>{let o=null;for(let p=0;p<i.length;p++){const c=i[p];c.isIntersecting&&(!o||c.intersectionRatio>o.intersectionRatio)&&(o=c)}if(o&&o.target){const p=o.target.getAttribute("data-requirement-id")||"";p&&Ie(p)}},{root:null,threshold:[.35,.5,.65],rootMargin:"-20% 0px -65% 0px"});return s.forEach(i=>n.observe(i)),()=>n.disconnect()},[A]),u.useEffect(()=>{const t=String(Q||"").trim();if(!t||ue[t])return;let s=!1;return(async()=>{Xe(t);try{const n=await ct(m,{requirementId:t});if(s)return;Ye(i=>({...i,[t]:n||null}))}catch{}finally{s||Xe("")}})(),()=>{s=!0}},[Q,m,ue]),u.useEffect(()=>{(async()=>{try{const t=await cs(m);Pt(String((t==null?void 0:t.interviewMessageTemplate)||""))}catch{}})()},[]);async function Mt(t){if(!d("REQUIREMENT_APPROVE",["HR","ADMIN"])){a.error("Not allowed");return}try{await gs(m,{requirementId:t}),a.success("Moved to Process"),await v(S)}catch(s){a.error((s==null?void 0:s.message)||"Approve failed")}}function $(t){return yt[t]||{NAUKRI:!1,APNA:!1,INDEED:!1,WORKINDIA:!1,customEnabled:!1,customName:""}}function Se(t,s){It(n=>({...n,[t]:{...$(t),...s}}))}async function Bt(t){if(!d("JOBPOST_INIT",["HR","ADMIN"])){a.error("Not allowed");return}try{await bs(m,{requirementId:t}),a.success("JobPosting initialized"),await v(S)}catch(s){a.error((s==null?void 0:s.message)||"Init failed")}}async function Ht(t){if(!d("JOBPOST_SET_PORTALS",["HR","ADMIN"])){a.error("Not allowed");return}const s=$(t),n=[];if(s.NAUKRI&&n.push("NAUKRI"),s.APNA&&n.push("APNA"),s.INDEED&&n.push("INDEED"),s.WORKINDIA&&n.push("WORKINDIA"),s.customEnabled){const i=String(s.customName||"").trim();if(!i){a.error("Enter custom portal name");return}n.push(i)}try{await ys(m,{requirementId:t,portals:n}),a.success("Portals saved"),await v(S)}catch(i){a.error((i==null?void 0:i.message)||"Failed to set portals")}}async function je(t){const s=await t.arrayBuffer();let n="";const i=new Uint8Array(s);for(let o=0;o<i.length;o++)n+=String.fromCharCode(i[o]);return btoa(n)}function X(t){return Rt[t]||{candidateName:"",mobile:"",source:"",file:null}}function Z(t,s){vt(n=>({...n,[t]:{...X(t),...s}}))}async function Wt(t){if(!d("FILE_UPLOAD_CV",["HR","ADMIN"])||!d("CANDIDATE_ADD",["HR","ADMIN"])){a.error("Not allowed");return}const s=X(t),n=String(s.candidateName||"").trim(),i=String(s.mobile||"").trim(),o=String(s.source||"").trim(),p=s.file;if(!n||!i||!p){a.error("Name, Mobile and CV are required");return}We(t);try{const c=await je(p),b=await ut(m,{requirementId:t,filename:p.name,mimeType:p.type||"application/octet-stream",base64:c});await hs(m,{requirementId:t,candidateName:n,mobile:i,source:o,cvFileId:b.fileId,cvFileName:b.fileName||p.name}),a.success("Candidate added"),Z(t,{candidateName:"",mobile:"",source:"",file:null}),await v(S)}catch(c){a.error((c==null?void 0:c.message)||"Add candidate failed")}finally{We("")}}function Ut(t){var c,b;const n=String(t||"").replace(/\.[^.]+$/,"").split("_");if(n.length<3)return null;const i=(c=n[0])==null?void 0:c.trim(),o=(b=n[1])==null?void 0:b.trim(),p=n.slice(2).join("_").trim();return!i||!o||!p?null:{candidateName:i,mobile:o,source:p}}async function et(t,s){var p;if(!d("FILE_UPLOAD_CV",["HR","ADMIN"])||!d("CANDIDATE_BULK_ADD",["HR","ADMIN"])){a.error("Not allowed");return}const n=Array.from(s||[]);if(n.length===0)return;if(n.length>50){a.error("Max 50 files");return}V({open:!0,current:0,total:n.length,errors:[]});const i=[],o=[];for(let c=0;c<n.length;c++){const b=n[c];V(L=>({...L,current:c+1}));const E=Ut(b.name);if(!E){o.push({file:b.name,message:"Parse failed (expected Name_Mobile_Source)"});continue}try{const L=await je(b),ee=await ut(m,{requirementId:t,filename:b.name,mimeType:b.type||"application/octet-stream",base64:L});i.push({candidateName:E.candidateName,mobile:E.mobile,source:E.source,cvFileId:ee.fileId,cvFileName:ee.fileName||b.name})}catch(L){o.push({file:b.name,message:(L==null?void 0:L.message)||"Upload failed"})}}try{if(i.length>0){const c=await ms(m,{requirementId:t,items:i});(c.errors||[]).forEach(b=>o.push({file:`item#${b.index}`,message:b.message})),a.success(`Bulk added: ${((p=c.created)==null?void 0:p.length)||0}`)}else a.error("No valid files to add");await v(S)}catch(c){a.error((c==null?void 0:c.message)||"Bulk add failed")}finally{V(c=>({...c,open:!0,errors:o}))}}function $t(t){return Et[t]||"SHORTLISTING"}function he(t,s){Ue(n=>({...n,[t]:s}))}function Kt(t,s){ye(""),de({open:!0,requirementId:t,candidate:s})}function ke(t){return Ct[t]||{}}function Ft(t,s,n){Ke(i=>{const p={...i[t]||{}};return n?p[s]=!0:delete p[s],{...i,[t]:p}})}async function Jt(t){if(!d("SHORTLIST_DECIDE",["HR","ADMIN"])){a.error("Not allowed");return}const s=Object.keys(ke(t));if(s.length===0){a.error("Select candidates");return}const n=String(z||"").toUpperCase().trim(),i=String(Ve||"").trim();if((n==="HOLD"||n==="REJECT")&&!i){a.error("Remark required");return}ce({open:!1,requirementId:""}),G({open:!0,current:0,total:s.length,errors:[]});let o=0;const p=[];for(let c=0;c<s.length;c++){const b=s[c];G(E=>({...E,current:c+1}));try{await mt(m,{requirementId:t,candidateId:b,decision:n,remark:i}),o++}catch(E){p.push({file:`${b}`,message:(E==null?void 0:E.message)||"Failed"})}}G(c=>({...c,errors:p})),p.length?a.error(`Bulk updated: ${o}, errors: ${p.length}`):a.success(`Bulk updated: ${o}`),Ke(c=>({...c,[t]:{}})),await v(S)}async function Re(t){var p;if(!d("SHORTLIST_DECIDE",["HR","ADMIN"])){a.error("Not allowed");return}if(String(t||"").toUpperCase()==="OWNER_SEND"&&!Ne("BTN_SHORTLIST_OWNER_SEND",["HR","ADMIN"])){a.error("Not allowed");return}const s=D.requirementId,n=(p=D.candidate)==null?void 0:p.candidateId;if(!s||!n)return;const i=String($e||"").trim();if((t==="REJECT"||t==="HOLD")&&!i){a.error("Remark required");return}const o=`${s}:${n}:${t}`;W(o);try{await mt(m,{requirementId:s,candidateId:n,decision:t,remark:i}),a.success("Updated"),de({open:!1,requirementId:"",candidate:null}),ye(""),await v(S)}catch(c){a.error((c==null?void 0:c.message)||"Failed")}finally{W("")}}async function Vt(t,s){if(!d("SHORTLIST_HOLD_REVERT",["HR","ADMIN"])){a.error("Not allowed");return}const n=`${t}:${s}:REVERT`;W(n);try{await ps(m,{requirementId:t,candidateId:s,remark:"Revert"}),a.success("Reverted"),await v(S)}catch(i){a.error((i==null?void 0:i.message)||"Revert failed")}finally{W("")}}async function zt(t,s,n){if(!n)return;if(!d("JOBPOST_UPLOAD_SCREENSHOT",["HR","ADMIN"])){a.error("Not allowed");return}const i=`${t}:${s}`;Oe(i);try{const o=await je(n);await Is(m,{requirementId:t,portalKey:s,filename:n.name,mimeType:n.type||"application/octet-stream",base64:o}),a.success("Screenshot uploaded"),await v(S)}catch(o){a.error((o==null?void 0:o.message)||"Upload failed")}finally{Oe("")}}async function Gt(t,s){if(!d("JOBPOST_MARK_PORTAL",["HR","ADMIN"])){a.error("Not allowed");return}const n=`${t}:${s}`;_e(n);try{await Ss(m,{requirementId:t,portalKey:s}),a.success("Marked posted"),await v(S)}catch(i){a.error((i==null?void 0:i.message)||"Mark failed")}finally{_e("")}}async function Qt(t){if(!d("JOBPOST_COMPLETE",["HR","ADMIN"])){a.error("Not allowed");return}Me(t);try{await js(m,{requirementId:t}),a.success("JobPosting complete"),await v(S)}catch(s){a.error((s==null?void 0:s.message)||"Complete failed")}finally{Me("")}}async function Yt(t){if(!d("REQUIREMENT_GET",["HR","ADMIN"])){a.error("Not allowed");return}Be(t);try{const s=ue[t],n=s||await ct(m,{requirementId:t});s||Ye(o=>({...o,[t]:n||null}));const i=String((n==null?void 0:n.jd)||"").trim();if(!i){a.error("JD is empty");return}await navigator.clipboard.writeText(i),a.success("JD copied")}catch(s){a.error((s==null?void 0:s.message)||"Copy failed")}finally{Be("")}}async function Xt(){if(!le)return;if(!d("REQUIREMENT_CLARIFICATION",["HR","ADMIN"])){a.error("Not allowed");return}const t=String(Pe||"").trim();if(!t){a.error("Remark required");return}try{await fs(m,{requirementId:le,remark:t}),a.success("Sent to EA for clarification"),be(""),oe(""),await v(S)}catch(s){a.error((s==null?void 0:s.message)||"Clarification failed")}}function Zt(t,s){const n=Ot[t];return n||(Number(s||0)===0?"BULK":"LIST")}function ve(t,s){_t(n=>({...n,[t]:s}))}function es(t){var o;const s=String((t==null?void 0:t.status)||"").toUpperCase(),n=String(((o=t==null?void 0:t.jobPostingState)==null?void 0:o.status)||(t==null?void 0:t.jobPostingStatus)||"").toUpperCase(),i=Number((t==null?void 0:t.candidateCount)||((t==null?void 0:t.candidates)||[]).length||0);return s==="SUBMITTED"?"REVIEW":s==="APPROVED"&&n!=="COMPLETE"?"SOURCE":n==="COMPLETE"&&i===0?"CANDIDATES":n==="COMPLETE"&&i>0?"REVIEW":"JOB"}const O=u.useMemo(()=>!A||A.length===0?null:A.find(t=>t.requirementId===Q)||A[0]||null,[A,Q]);return e.jsxs("div",{className:"hr-review",style:{padding:16},children:[gt("PORTAL_HR_REVIEW",["HR","ADMIN"])?null:e.jsxs("div",{className:"card",style:{padding:12,marginBottom:12},children:[e.jsx("div",{style:{fontWeight:700},children:"Not allowed"}),e.jsx("div",{className:"hr-muted",children:"You don’t have access to HR Review portal."})]}),e.jsxs("div",{className:"hr-stickyContext",role:"region","aria-label":"Current requirement context",children:[e.jsxs("div",{className:"hr-stickyLeft",children:[e.jsx("div",{className:"hr-stickyTitle",children:"Current Requirement"}),e.jsx("div",{className:"hr-stickyMeta",children:O?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hr-mono",children:O.requirementId}),e.jsx("span",{className:"hr-dot",children:"•"}),e.jsx("span",{children:O.jobTitle||O.jobRole||O.templateId||"-"}),e.jsx("span",{className:"hr-dot",children:"•"}),e.jsxs("span",{children:["Candidates: ",Number(O.candidateCount||0)]}),e.jsx("span",{className:"hr-dot",children:"•"}),e.jsxs("span",{children:["Status: ",String(O.status||"-")]})]}):e.jsx("span",{style:{color:"#666"},children:"No selection"})})]}),e.jsx("div",{className:"hr-stepper","aria-label":"Workflow steps",children:(()=>{const t=O?es(O):"JOB";return[{k:"JOB",label:"Job Info"},{k:"SOURCE",label:"Source Upload"},{k:"CANDIDATES",label:"Candidates"},{k:"REVIEW",label:"Review"}].map((n,i)=>e.jsxs("div",{className:"hr-step"+(t===n.k?" isActive":""),children:[e.jsx("span",{className:"hr-stepNum",children:i+1}),e.jsx("span",{className:"hr-stepLabel",children:n.label})]},n.k))})()})]}),e.jsx("h2",{style:{marginBottom:12},children:"HR Review"}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12,flexWrap:"wrap"},children:[ks.map(t=>e.jsxs("button",{onClick:()=>De(t.key),style:{padding:"6px 10px",border:"1px solid #ddd",borderRadius:6,background:S===t.key?"#f3f3f3":"#fff",cursor:"pointer"},children:[t.label," ",Ze[t.key]?`(${Ze[t.key]})`:""]},t.key)),e.jsx("button",{onClick:()=>v(S),style:{padding:"6px 10px",border:"1px solid #ddd",borderRadius:6,background:"#fff",cursor:"pointer",marginLeft:"auto"},children:"Refresh"})]}),we?e.jsx("div",{children:"Loading…"}):null,A.length===0&&!we?e.jsx("div",{style:{color:"#666"},children:"No items."}):e.jsx("div",{style:{display:"grid",gap:10},children:A.map(t=>{var s,n,i,o,p,c,b,E,L,ee;return e.jsxs("div",{className:"hr-card","data-requirement-id":t.requirementId,ref:h=>{Y.current||(Y.current={}),h?Y.current[t.requirementId]=h:delete Y.current[t.requirementId]},style:{border:"1px solid #eee",borderRadius:10,padding:12},children:[e.jsxs("button",{type:"button",className:"hr-cardHeader",onClick:()=>Ie(t.requirementId),style:{width:"100%",textAlign:"left"},children:[e.jsx("div",{className:"hr-cardTitle",children:t.jobTitle||t.jobRole||t.templateId||t.requirementId}),e.jsxs("div",{className:"hr-cardSub",children:[e.jsx("span",{className:"hr-mono",children:t.requirementId}),e.jsx("span",{className:"hr-dot",children:"•"}),e.jsx("span",{children:Rs(t.status)}),t.jobPostingStatus?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hr-dot",children:"•"}),e.jsxs("span",{children:["JobPosting: ",t.jobPostingStatus]})]}):null,e.jsx("span",{className:"hr-dot",children:"•"}),e.jsxs("span",{children:["Candidates: ",Number(t.candidateCount||0)]})]}),e.jsx(Ns,{sla:t.sla})]}),e.jsxs("div",{className:"hr-sections",children:[e.jsxs("details",{className:"hr-section",children:[e.jsx("summary",{className:"hr-summary",children:"Job Information"}),e.jsx("div",{className:"hr-sectionBody",children:(()=>{const x=ue[t.requirementId]||t,f=qt===t.requirementId;return e.jsxs("div",{className:"hr-kv",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Role:"})," ",x.jobRole||"-"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Title:"})," ",x.jobTitle||"-"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Shift:"})," ",x.shift||"-"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Pay Scale:"})," ",x.payScale||"-"]}),e.jsxs("div",{children:[e.jsx("b",{children:"Required:"})," ",x.requiredCount??"-"," • ",e.jsx("b",{children:"Joined:"})," ",x.joinedCount??"-"]}),x.notes?e.jsxs("div",{children:[e.jsx("b",{children:"Notes:"})," ",e.jsx("span",{style:{whiteSpace:"pre-wrap"},children:x.notes})]}):null,x.raisedFor?e.jsxs("div",{children:[e.jsx("b",{children:"Raised For:"})," ",x.raisedFor]}):null,x.concernedPerson?e.jsxs("div",{children:[e.jsx("b",{children:"Concerned Person:"})," ",x.concernedPerson]}):null,f?e.jsx("div",{className:"hr-muted",children:"Loading full details…"}):null,e.jsxs("div",{style:{marginTop:10,display:"grid",gap:8},children:[e.jsxs("details",{className:"hr-section",children:[e.jsx("summary",{className:"hr-summary",children:"JD"}),e.jsx("div",{className:"hr-sectionBody",style:{whiteSpace:"pre-wrap"},children:x.jd||"-"})]}),e.jsxs("details",{className:"hr-section",children:[e.jsx("summary",{className:"hr-summary",children:"Responsibilities"}),e.jsx("div",{className:"hr-sectionBody",style:{whiteSpace:"pre-wrap"},children:x.responsibilities||"-"})]}),e.jsxs("details",{className:"hr-section",children:[e.jsx("summary",{className:"hr-summary",children:"Skills"}),e.jsx("div",{className:"hr-sectionBody",style:{whiteSpace:"pre-wrap"},children:x.skills||"-"})]}),e.jsxs("details",{className:"hr-section",children:[e.jsx("summary",{className:"hr-summary",children:"Perks"}),e.jsx("div",{className:"hr-sectionBody",style:{whiteSpace:"pre-wrap"},children:x.perks||"-"})]})]}),t.latestRemark?e.jsxs("div",{children:[e.jsx("b",{children:"Latest Remark:"})," ",t.latestRemark]}):null]})})()})]}),e.jsxs("details",{className:"hr-section",open:String(t.status||"").toUpperCase()==="APPROVED"&&String(((s=t.jobPostingState)==null?void 0:s.status)||"").toUpperCase()!=="COMPLETE",children:[e.jsx("summary",{className:"hr-summary",children:"Source Upload (Naukri / Apna / etc)"}),e.jsx("div",{className:"hr-sectionBody",children:String(t.status||"").toUpperCase()==="APPROVED"?e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[e.jsx("div",{style:{fontWeight:600},children:"Job Posting"}),e.jsxs("div",{style:{fontSize:12,color:"#666"},children:["Status: ",((n=t.jobPostingState)==null?void 0:n.status)||"NOT_STARTED"]}),e.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,flexWrap:"wrap"},children:e.jsx("button",{onClick:()=>Yt(t.requirementId),disabled:kt===t.requirementId||!d("REQUIREMENT_GET",["HR","ADMIN"]),className:"hr-btn hr-btnSecondary",children:"Copy JD"})})]}),t.jobPostingState?null:e.jsx("div",{style:{marginTop:10},children:e.jsx("button",{onClick:()=>Bt(t.requirementId),className:"hr-btn hr-btnPrimary",disabled:!d("JOBPOST_INIT",["HR","ADMIN"]),children:"Init JobPosting"})}),t.jobPostingState?e.jsx(e.Fragment,{children:Array.isArray((o=(i=t.jobPostingState)==null?void 0:i.checklistState)==null?void 0:o.selectedPortals)&&t.jobPostingState.checklistState.selectedPortals.length>0?e.jsxs("div",{style:{marginTop:10,display:"grid",gap:10},children:[(t.jobPostingState.checklistState.selectedPortals||[]).map(h=>{var F,y,te;const x=((F=t.jobPostingState.checklistState.portals)==null?void 0:F[h.key])||{},f=!!x.screenshotFileId,C=!!x.posted,w=St===`${t.requirementId}:${h.key}`,K=jt===`${t.requirementId}:${h.key}`;return e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:8,padding:10,display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("div",{style:{minWidth:160},children:[e.jsx("div",{style:{fontWeight:600},children:h.label}),e.jsxs("div",{style:{fontSize:12,color:"#666"},children:[C?"Posted":"Not posted",f?" • Screenshot uploaded":" • Screenshot required"]})]}),e.jsxs("label",{style:{fontSize:12},children:["Screenshot",e.jsx("input",{type:"file",accept:"image/*",disabled:String(((y=t.jobPostingState)==null?void 0:y.status)||"").toUpperCase()==="COMPLETE"||!d("JOBPOST_UPLOAD_SCREENSHOT",["HR","ADMIN"]),onChange:me=>{var ge;const pe=(ge=me.target.files)==null?void 0:ge[0];pe&&(zt(t.requirementId,h.key,pe),me.target.value="")},style:{display:"block",marginTop:4}})]}),e.jsx("button",{onClick:()=>Gt(t.requirementId,h.key),disabled:String(((te=t.jobPostingState)==null?void 0:te.status)||"").toUpperCase()==="COMPLETE"||!f||C||w||K||!d("JOBPOST_MARK_PORTAL",["HR","ADMIN"]),className:"hr-btn hr-btnPrimary",children:K?"Marking…":"Mark Posted"}),w?e.jsx("div",{style:{fontSize:12,color:"#666"},children:"Uploading…"}):null]},h.key)}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[e.jsx("button",{onClick:()=>Qt(t.requirementId),disabled:qe===t.requirementId||String(((p=t.jobPostingState)==null?void 0:p.status)||"").toUpperCase()==="COMPLETE"||!d("JOBPOST_COMPLETE",["HR","ADMIN"]),className:"hr-btn hr-btnPrimary",children:String(((c=t.jobPostingState)==null?void 0:c.status)||"").toUpperCase()==="COMPLETE"?"JobPosting Complete":qe===t.requirementId?"Completing…":"Complete"}),e.jsx("button",{type:"button",onClick:()=>{const h=document.getElementById(`cand-${t.requirementId}`);h&&h.scrollIntoView({behavior:"smooth",block:"start"})},disabled:String(((b=t.jobPostingState)==null?void 0:b.status)||"").toUpperCase()!=="COMPLETE",className:"hr-btn hr-btnMuted",children:"Add Candidate"})]})]}):e.jsxs("div",{style:{marginTop:10,display:"grid",gap:8},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:"Which portals posted on?"}),e.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[[{key:"NAUKRI",label:"Naukri"},{key:"APNA",label:"Apna"},{key:"INDEED",label:"Indeed"},{key:"WORKINDIA",label:"WorkIndia"}].map(h=>e.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsx("input",{type:"checkbox",checked:!!$(t.requirementId)[h.key],onChange:x=>Se(t.requirementId,{[h.key]:x.target.checked})}),h.label]},h.key)),e.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsx("input",{type:"checkbox",checked:!!$(t.requirementId).customEnabled,onChange:h=>Se(t.requirementId,{customEnabled:h.target.checked})}),"Custom"]}),$(t.requirementId).customEnabled?e.jsx("input",{value:$(t.requirementId).customName,onChange:h=>Se(t.requirementId,{customName:h.target.value}),placeholder:"Custom portal name",style:{padding:8,border:"1px solid #ddd",borderRadius:6,minWidth:220}}):null]}),e.jsx("button",{onClick:()=>Ht(t.requirementId),className:"hr-btn hr-btnPrimary",disabled:!d("JOBPOST_SET_PORTALS",["HR","ADMIN"]),children:"Set Portals"})]})}):null,String(((E=t.jobPostingState)==null?void 0:E.status)||"").toUpperCase()!=="COMPLETE"?e.jsx("div",{style:{marginTop:10,fontSize:12,color:"#666"},children:'Note: "Add Candidate" and "Walk-in" will appear after JobPosting is COMPLETE.'}):null]}):null})]}),e.jsxs("details",{className:"hr-section",id:`cand-${t.requirementId}`,open:String(((L=t.jobPostingState)==null?void 0:L.status)||"").toUpperCase()==="COMPLETE",children:[e.jsx("summary",{className:"hr-summary",children:"Candidates"}),e.jsx("div",{className:"hr-sectionBody",children:String(((ee=t.jobPostingState)==null?void 0:ee.status)||"").toUpperCase()==="COMPLETE"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hr-candHeader",children:[e.jsxs("div",{className:"hr-candTitle",children:["Candidates ",e.jsxs("span",{className:"hr-muted",children:["(",t.candidateCount||0,")"]})]}),(()=>{const h=(t.candidates||[]).filter(x=>String(x.status||"").toUpperCase()==="WALKIN_PENDING").length;return h?e.jsxs("div",{className:"hr-muted",children:["Walk-in Pending: ",h]}):null})()]}),(()=>{const h=Zt(t.requirementId,t.candidateCount||0),x=(t.candidates||[]).length;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hr-tabs",role:"tablist","aria-label":"Candidates",children:[e.jsx("button",{type:"button",className:"hr-tab"+(h==="ADD"?" isActive":""),onClick:()=>ve(t.requirementId,"ADD"),children:"Add Single"}),e.jsx("button",{type:"button",className:"hr-tab"+(h==="BULK"?" isActive":""),onClick:()=>ve(t.requirementId,"BULK"),children:"Bulk Upload"}),e.jsxs("button",{type:"button",className:"hr-tab"+(h==="LIST"?" isActive":""),onClick:()=>ve(t.requirementId,"LIST"),children:["Candidate List (",x,")"]})]}),h==="ADD"?e.jsxs("div",{className:"hr-panel",children:[e.jsx("div",{className:"hr-panelTitle",children:"Add single candidate"}),e.jsxs("div",{className:"hr-row",children:[e.jsx("input",{placeholder:"Candidate Name",value:X(t.requirementId).candidateName,onChange:f=>Z(t.requirementId,{candidateName:f.target.value}),className:"hr-input"}),e.jsx("input",{placeholder:"Mobile Number",value:X(t.requirementId).mobile,onChange:f=>Z(t.requirementId,{mobile:f.target.value}),className:"hr-input hr-inputSm"}),e.jsx("input",{placeholder:"Source",value:X(t.requirementId).source,onChange:f=>Z(t.requirementId,{source:f.target.value}),className:"hr-input hr-inputSm"}),e.jsxs("label",{className:"hr-label",children:["Upload CV",e.jsx("input",{type:"file",accept:".pdf,.doc,.docx,image/*",disabled:!d("FILE_UPLOAD_CV",["HR","ADMIN"])||!d("CANDIDATE_ADD",["HR","ADMIN"]),onChange:f=>{var w;const C=(w=f.target.files)==null?void 0:w[0];C&&Z(t.requirementId,{file:C})},style:{display:"block",marginTop:4}})]}),e.jsx("button",{type:"button",onClick:()=>Wt(t.requirementId),disabled:He===t.requirementId||!d("FILE_UPLOAD_CV",["HR","ADMIN"])||!d("CANDIDATE_ADD",["HR","ADMIN"]),className:"hr-btn hr-btnPrimary",children:He===t.requirementId?"Saving…":"Add"})]}),e.jsxs("div",{className:"hr-muted",style:{marginTop:6},children:["Role auto from requirement: ",t.jobRole]})]}):null,h==="BULK"?e.jsxs("div",{className:"hr-panel hr-dropzone",onDragOver:f=>{f.preventDefault(),f.stopPropagation()},onDrop:f=>{var w;f.preventDefault(),f.stopPropagation();const C=(w=f.dataTransfer)==null?void 0:w.files;!C||C.length===0||et(t.requirementId,C)},children:[e.jsx("div",{className:"hr-panelTitle",children:"Bulk upload (≤ 50)"}),e.jsxs("div",{className:"hr-muted",style:{marginBottom:8},children:["Drag & drop files here or browse. Filename format: ",e.jsx("span",{className:"hr-mono",children:"Name_Mobile_Source"})]}),e.jsxs("div",{className:"hr-row",style:{alignItems:"flex-end"},children:[e.jsxs("label",{className:"hr-label",children:["Select files",e.jsx("input",{type:"file",multiple:!0,accept:".pdf,.doc,.docx,image/*",disabled:!d("FILE_UPLOAD_CV",["HR","ADMIN"])||!d("CANDIDATE_BULK_ADD",["HR","ADMIN"]),onChange:f=>{const C=f.target.files;C&&(et(t.requirementId,C),f.target.value="")},style:{display:"block",marginTop:4}})]}),e.jsx("div",{className:"hr-muted",children:"Tip: keep sources consistent (e.g., NAUKRI / APNA)."})]})]}):null,h==="LIST"?e.jsxs("div",{className:"hr-panel",children:[e.jsx("div",{className:"hr-panelTitle",children:"Candidate list"}),(()=>{const f=t.candidates||[],C=f.filter(r=>String(r.status||"").toUpperCase()==="NEW"),w=f.filter(r=>String(r.status||"").toUpperCase()==="HOLD"),K=f.filter(r=>{const l=String(r.status||"").toUpperCase();return l==="OWNER"||l==="OWNER_HOLD"}),F=f.filter(r=>{const l=String(r.status||"").toUpperCase();return l==="WALKIN_PENDING"||l==="WALKIN_SCHEDULED"}),y=$t(t.requirementId),te=y==="HOLD"?w:y==="OWNER"?K:y==="WALKIN"?F:C;function me(r){const l=String((r==null?void 0:r.cvFileId)||"").trim();if(!l){a.error("CV not available");return}xs(l,m)||a.error("Unable to open CV")}function pe(r){if(!r)return"";const l=r instanceof Date?r:new Date(r);if(Number.isNaN(l.getTime()))return"";const g=N=>String(N).padStart(2,"0");return`${l.getFullYear()}-${g(l.getMonth()+1)}-${g(l.getDate())}T${g(l.getHours())}:${g(l.getMinutes())}`}function ge(r){const l=g=>String(g).padStart(2,"0");return`${l(r.getDate())}-${l(r.getMonth()+1)}-${r.getFullYear()}`}function ts(r){const l=j=>String(j).padStart(2,"0");let g=r.getHours();const N=r.getMinutes(),I=g>=12?"PM":"AM";return g=g%12,g===0&&(g=12),`${l(g)}:${l(N)} ${I}`}function ss({candidateName:r,jobTitle:l,at:g}){const N=String(Qe||"");if(!N.trim())return"";const I=ge(g),j=ts(g),k=[["Candidate Name",r],["Job Title",l],["Date",I],["Time",j]];let _=N;return k.forEach(([q,Ae])=>{const T=String(Ae??"");[new RegExp(`\\{\\{\\s*${q}\\s*\\}\\}`,"g"),new RegExp(`\\[\\s*${q}\\s*\\]`,"g"),new RegExp(`<<\\s*${q}\\s*>>`,"g")].forEach(J=>{_=_.replace(J,T)})}),_}function fe(r,l){const g=`${r}:${l.candidateId}`,N=At[g];return N||{walkinAtLocal:pe(l.walkinAt),notes:String(l.walkinNotes||"")}}function Ee(r){const l=String((r==null?void 0:r.status)||"").toUpperCase();return!!(r&&r.walkinAt)||l==="WALKIN_SCHEDULED"||l==="WALKIN_SET"}function ot(r,l,g){const N=`${r}:${l}`;Tt(I=>({...I,[N]:{...I[N]||{},...g}}))}async function ns(r,l){if(!d("WALKIN_SCHEDULE",["HR","ADMIN"])){a.error("Not allowed");return}if(Ee(l)){a.error("Walk-in already scheduled");return}if(String((l==null?void 0:l.status)||"").toUpperCase()!=="WALKIN_PENDING"){a.error("Owner approval required before scheduling");return}const N=`${r}:${l.candidateId}:WALKIN_SAVE`,I=fe(r,l),j=String(I.walkinAtLocal||"").trim();if(!j){a.error("Select date/time");return}const k=pt(j);if(!k.ok){a.error(k.message);return}const _=k.date;W(N);try{await ht(m,{requirementId:r,candidateId:l.candidateId,walkinAt:_.toISOString(),notes:String(I.notes||"")}),a.success("Walk-in scheduled"),await v(S)}catch(q){a.error((q==null?void 0:q.message)||"Save failed")}finally{W("")}}function Ce(r){return Dt[r]||{}}function rs(r,l,g){Ge(N=>{const j={...N[r]||{}};return g?j[l]=!0:delete j[l],{...N,[r]:j}})}function xe(r){return wt[r]||{walkinAtLocal:"",notes:""}}function dt(r,l){Lt(g=>({...g,[r]:{...xe(r),...l}}))}async function as(r){if(!d("WALKIN_SCHEDULE",["HR","ADMIN"])){a.error("Not allowed");return}const l=Object.keys(Ce(r));if(l.length===0){a.error("Select candidates");return}const g=t&&t.candidates||[],N=new Map(g.map(T=>[String(T.candidateId),T])),I=l.filter(T=>{const M=N.get(String(T)),J=String((M==null?void 0:M.status)||"").toUpperCase();return M&&J==="WALKIN_PENDING"&&!Ee(M)});if(I.length===0){a.error("Selected candidates already have Walk-in scheduled");return}const j=xe(r),k=String(j.walkinAtLocal||"").trim();if(!k){a.error("Select date/time");return}const _=pt(k);if(!_.ok){a.error(_.message);return}const q=_.date,Ae=`${r}:WALKIN_BULK`;W(Ae);try{const T=await ht(m,{requirementId:r,candidateIds:I,walkinAt:q.toISOString(),notes:String(j.notes||"")}),M=(T.updated||[]).length,J=(T.errors||[]).length;J?a.error(`Bulk scheduled: ${M}, errors: ${J}`):a.success(`Bulk scheduled: ${M}`),Ge(ls=>({...ls,[r]:{}})),await v(S)}catch(T){a.error((T==null?void 0:T.message)||"Bulk save failed")}finally{W("")}}async function is(r,l){if(!d("COPY_TEMPLATE_DATA",["HR","ADMIN"])){a.error("Not allowed");return}if(!String(Qe||"").trim()){a.error("Interview template not set (Admin → Settings)");return}const g=fe(r,l),N=l.walkinAt||(g.walkinAtLocal?new Date(g.walkinAtLocal).toISOString():"");if(!N){a.error("Set date/time first");return}const I=new Date(N);if(Number.isNaN(I.getTime())){a.error("Invalid date/time");return}const j=String(t.jobTitle||t.jobRole||l.jobRole||"").trim(),k=ss({candidateName:Te(l)||l.candidateId||"",jobTitle:j,at:I});if(!k){a.error("Template empty");return}await navigator.clipboard.writeText(k),a.success("Interview message copied")}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hr-subTabs",children:[e.jsxs("button",{type:"button",onClick:()=>he(t.requirementId,"SHORTLISTING"),className:"hr-subTab"+(y==="SHORTLISTING"?" isActive":""),children:["Shortlisting ",C.length?`(${C.length})`:""]}),e.jsxs("button",{type:"button",onClick:()=>he(t.requirementId,"HOLD"),className:"hr-subTab"+(y==="HOLD"?" isActive":""),children:["Hold ",w.length?`(${w.length})`:""]}),e.jsxs("button",{type:"button",onClick:()=>he(t.requirementId,"OWNER"),className:"hr-subTab"+(y==="OWNER"?" isActive":""),children:["Owner ",K.length?`(${K.length})`:""]}),e.jsxs("button",{type:"button",onClick:()=>he(t.requirementId,"WALKIN"),className:"hr-subTab"+(y==="WALKIN"?" isActive":""),children:["Walk-in ",F.length?`(${F.length})`:""]})]}),te.length===0?e.jsx("div",{className:"hr-muted",children:"No candidates."}):e.jsxs("div",{className:"hr-candScroll",children:[y==="WALKIN"?e.jsxs("div",{className:"hr-walkinPanel",children:[e.jsx("div",{className:"hr-walkinTitle",children:"Walk-in Scheduling"}),e.jsxs("div",{className:"hr-row",style:{alignItems:"flex-end"},children:[e.jsxs("div",{className:"hr-muted",children:["Selected: ",Object.keys(Ce(t.requirementId)).length]}),e.jsxs("label",{className:"hr-label",children:["Bulk Date/Time",e.jsx("input",{type:"datetime-local",value:xe(t.requirementId).walkinAtLocal,onChange:r=>dt(t.requirementId,{walkinAtLocal:r.target.value}),className:"hr-input hr-inputXs"})]}),e.jsxs("label",{className:"hr-label",children:["Bulk Notes",e.jsx("input",{value:xe(t.requirementId).notes,onChange:r=>dt(t.requirementId,{notes:r.target.value}),className:"hr-input"})]}),e.jsx("button",{type:"button",onClick:()=>as(t.requirementId),disabled:P===`${t.requirementId}:WALKIN_BULK`||!d("WALKIN_SCHEDULE",["HR","ADMIN"]),className:"hr-btn hr-btnPrimary",children:P===`${t.requirementId}:WALKIN_BULK`?"Applying…":"Apply to Selected"})]}),e.jsxs("div",{className:"hr-muted",style:{marginTop:8},children:["Template placeholders supported: ","{{Candidate Name}}",", ","{{Job Title}}",", ","{{Date}}",", ","{{Time}}"]})]}):null,y==="SHORTLISTING"?e.jsxs("div",{className:"hr-walkinPanel",children:[e.jsx("div",{className:"hr-walkinTitle",children:"Bulk Shortlisting"}),e.jsxs("div",{className:"hr-row",style:{alignItems:"flex-end"},children:[e.jsxs("div",{className:"hr-muted",children:["Selected: ",Object.keys(ke(t.requirementId)).length]}),e.jsx("button",{type:"button",onClick:()=>{Je("OWNER_SEND"),ze(""),ce({open:!0,requirementId:t.requirementId})},disabled:!d("SHORTLIST_DECIDE",["HR","ADMIN"]),className:"hr-btn hr-btnPrimary",children:"Bulk Action"})]})]}):null,e.jsxs("table",{className:"hr-table",role:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[y==="WALKIN"||y==="SHORTLISTING"?e.jsx("th",{style:{width:90},children:"Select"}):null,e.jsx("th",{children:"Candidate"}),e.jsx("th",{style:{width:140},children:"Source"}),e.jsx("th",{style:{width:140},children:"Status"}),e.jsx("th",{style:{width:360},children:"Actions"})]})}),e.jsx("tbody",{children:te.map(r=>{const l=String(r.status||"").toUpperCase(),g=r.holdUntil?new Date(r.holdUntil).toLocaleString():"",N=r.walkinAt?new Date(r.walkinAt).toLocaleString():"",I=String(r.walkinNotes||"").trim(),j=y==="WALKIN"?Ee(r):!1;return e.jsxs("tr",{className:"hr-rowHover",children:[y==="WALKIN"?e.jsx("td",{children:e.jsxs("label",{className:"hr-inline",children:[e.jsx("input",{type:"checkbox",checked:!!Ce(t.requirementId)[r.candidateId],disabled:j,onChange:k=>rs(t.requirementId,r.candidateId,k.target.checked)}),e.jsx("span",{className:"hr-muted",children:j?"Locked":"Select"})]})}):y==="SHORTLISTING"?e.jsx("td",{children:e.jsxs("label",{className:"hr-inline",children:[e.jsx("input",{type:"checkbox",checked:!!ke(t.requirementId)[r.candidateId],onChange:k=>Ft(t.requirementId,r.candidateId,k.target.checked)}),e.jsx("span",{className:"hr-muted",children:"Select"})]})}):null,e.jsxs("td",{children:[e.jsxs("div",{style:{fontWeight:600},children:[Te(r)||r.candidateId," ",e.jsxs("span",{className:"hr-muted",style:{fontWeight:400},children:["(",r.candidateId,")"]})]}),l==="OWNER_HOLD"?e.jsxs("div",{className:"hr-muted",children:["Owner hold until: ",g||"-"]}):null,l==="WALKIN_PENDING"?e.jsx("div",{className:"hr-muted",children:"Walk-in pending (Owner approved)"}):null,j?e.jsxs("div",{className:"hr-muted",children:["Walk-in already scheduled: ",e.jsx("span",{className:"hr-mono",children:N||"-"})]}):l==="WALKIN_PENDING"?e.jsx("div",{className:"hr-muted",children:"Walk-in pending (Owner approved)"}):null,y==="WALKIN"&&I?e.jsxs("div",{className:"hr-muted",children:["Notes: ",I]}):null]}),e.jsx("td",{children:r.source||"-"}),e.jsx("td",{children:e.jsx("span",{className:"hr-badge",children:l||"-"})}),e.jsx("td",{children:e.jsxs("div",{className:"hr-actions",children:[e.jsx("button",{type:"button",onClick:()=>me(r),className:"hr-btn hr-btnSecondary",children:"View CV"}),y==="SHORTLISTING"?e.jsx("button",{type:"button",onClick:()=>Kt(t.requirementId,r),disabled:!d("SHORTLIST_DECIDE",["HR","ADMIN"]),className:"hr-btn hr-btnPrimary",children:"Shortlisting"}):null,y==="HOLD"?e.jsx("button",{type:"button",onClick:()=>Vt(t.requirementId,r.candidateId),disabled:P===`${t.requirementId}:${r.candidateId}:REVERT`||!d("SHORTLIST_HOLD_REVERT",["HR","ADMIN"]),className:"hr-btn hr-btnPrimary",children:P===`${t.requirementId}:${r.candidateId}:REVERT`?"Reverting…":"Revert"}):null,y==="OWNER"?e.jsx("span",{className:"hr-muted",children:"Locked (Owner)"}):null,y==="WALKIN"?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>is(t.requirementId,r),disabled:!d("COPY_TEMPLATE_DATA",["HR","ADMIN"]),className:"hr-btn hr-btnSecondary",children:"Copy Message"}),j?e.jsxs("div",{className:"hr-muted",style:{display:"grid",gap:2},children:[e.jsx("div",{style:{fontWeight:700,color:"var(--gray-900)"},children:"Walk-in already scheduled"}),e.jsxs("div",{children:["Date/Time: ",e.jsx("span",{className:"hr-mono",children:N||"-"})]}),I?e.jsxs("div",{children:["Notes: ",I]}):null]}):e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"hr-label",style:{margin:0},children:["Date/Time",e.jsx("input",{type:"datetime-local",value:fe(t.requirementId,r).walkinAtLocal,onChange:k=>ot(t.requirementId,r.candidateId,{walkinAtLocal:k.target.value}),className:"hr-input hr-inputXs"})]}),e.jsxs("label",{className:"hr-label",style:{margin:0},children:["Notes",e.jsx("input",{value:fe(t.requirementId,r).notes,onChange:k=>ot(t.requirementId,r.candidateId,{notes:k.target.value}),className:"hr-input"})]}),e.jsx("button",{type:"button",onClick:()=>ns(t.requirementId,r),disabled:P===`${t.requirementId}:${r.candidateId}:WALKIN_SAVE`||!d("WALKIN_SCHEDULE",["HR","ADMIN"]),className:"hr-btn hr-btnPrimary",children:P===`${t.requirementId}:${r.candidateId}:WALKIN_SAVE`?"Saving…":"Save"})]})]}):null]})})]},r.candidateId)})})]})]})]})})()]}):null]})})()]}):e.jsx("div",{className:"hr-muted",children:"Candidates will appear after JobPosting is COMPLETE."})})]}),e.jsxs("details",{className:"hr-section",open:String(t.status||"").toUpperCase()==="SUBMITTED"||le===t.requirementId,children:[e.jsx("summary",{className:"hr-summary",children:"Review / Actions"}),e.jsxs("div",{className:"hr-sectionBody",children:[String(t.status||"").toUpperCase()==="SUBMITTED"?e.jsxs("div",{className:"hr-actionsRow",children:[e.jsx("button",{onClick:()=>Mt(t.requirementId),className:"hr-btn hr-btnPrimary",disabled:!d("REQUIREMENT_APPROVE",["HR","ADMIN"]),children:"Approve"}),e.jsx("button",{onClick:()=>{be(t.requirementId),oe("")},className:"hr-btn hr-btnSecondary",disabled:!d("REQUIREMENT_CLARIFICATION",["HR","ADMIN"]),children:"Request Clarification"})]}):e.jsx("div",{className:"hr-muted",children:"No pending review actions."}),le===t.requirementId?e.jsxs("div",{style:{marginTop:12,display:"grid",gap:8},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:"Clarification Remark (required)"}),e.jsx("textarea",{rows:3,value:Pe,onChange:h=>oe(h.target.value),style:{padding:8,border:"1px solid #ddd",borderRadius:6},placeholder:"Enter remark for EA"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{onClick:Xt,className:"hr-btn hr-btnPrimary",disabled:!d("REQUIREMENT_CLARIFICATION",["HR","ADMIN"]),children:"Send"}),e.jsx("button",{onClick:()=>{be(""),oe("")},className:"hr-btn hr-btnMuted",children:"Cancel"})]})]}):null]})]})]})]},t.requirementId)})}),H.open?e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:50},onClick:()=>V(t=>({...t,open:!1})),children:e.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #eee",padding:14,width:"min(520px, 95vw)"},onClick:t=>t.stopPropagation(),children:[e.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Bulk Upload Progress"}),e.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:10},children:[H.current,"/",H.total," uploaded…"]}),e.jsx("div",{style:{height:10,background:"#f3f3f3",borderRadius:6,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:H.total?`${Math.round(H.current/H.total*100)}%`:"0%",background:"#ddd"}})}),(tt=H.errors)!=null&&tt.length?e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Errors (continued processing)"}),e.jsx("div",{style:{maxHeight:180,overflow:"auto",border:"1px solid #eee",borderRadius:8},children:e.jsx("ul",{style:{margin:0,padding:10,fontSize:12},children:H.errors.map((t,s)=>e.jsxs("li",{children:[t.file,": ",t.message]},s))})})]}):null,e.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:8},children:e.jsx("button",{type:"button",onClick:()=>V(t=>({...t,open:!1})),style:{padding:"6px 10px",border:"1px solid #ddd",borderRadius:6,background:"#fff",cursor:"pointer"},children:"Close"})})]})}):null,Fe.open?e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:55},onClick:()=>ce({open:!1,requirementId:""}),children:e.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #eee",padding:14,width:"min(520px, 95vw)"},onClick:t=>t.stopPropagation(),children:[e.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Bulk Action"}),e.jsx("div",{className:"small",style:{marginBottom:10},children:"Applies to selected candidates in Shortlisting."}),e.jsxs("div",{style:{display:"grid",gap:10},children:[e.jsxs("label",{className:"small",style:{display:"grid",gap:6},children:["Decision",e.jsxs("select",{value:z,onChange:t=>Je(t.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd"},children:[e.jsx("option",{value:"OWNER_SEND",children:"Owner Approval"}),e.jsx("option",{value:"HOLD",children:"Hold"}),e.jsx("option",{value:"REJECT",children:"Reject"})]})]}),e.jsxs("label",{className:"small",style:{display:"grid",gap:6},children:["Remark ",String(z).toUpperCase()==="HOLD"||String(z).toUpperCase()==="REJECT"?"(required)":"(optional)",e.jsx("textarea",{rows:3,value:Ve,onChange:t=>ze(t.target.value),style:{padding:8,borderRadius:8,border:"1px solid #d0d5dd"},placeholder:"Enter remark..."})]})]}),e.jsxs("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{type:"button",onClick:()=>ce({open:!1,requirementId:""}),className:"hr-btn hr-btnMuted",children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>Jt(Fe.requirementId),className:"hr-btn hr-btnPrimary",disabled:!d("SHORTLIST_DECIDE",["HR","ADMIN"])||String(z||"").toUpperCase()==="OWNER_SEND"&&!Ne("BTN_SHORTLIST_OWNER_SEND",["HR","ADMIN"]),children:"Apply"})]})]})}):null,U.open?e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:56},onClick:()=>G(t=>({...t,open:!1})),children:e.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #eee",padding:14,width:"min(520px, 95vw)"},onClick:t=>t.stopPropagation(),children:[e.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Bulk Shortlisting Progress"}),e.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:10},children:[U.current,"/",U.total," processed…"]}),e.jsx("div",{style:{height:10,background:"#f3f3f3",borderRadius:6,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:U.total?`${Math.round(U.current/U.total*100)}%`:"0%",background:"#ddd"}})}),(st=U.errors)!=null&&st.length?e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Errors (continued processing)"}),e.jsx("div",{style:{maxHeight:180,overflow:"auto",border:"1px solid #eee",borderRadius:8},children:e.jsx("ul",{style:{margin:0,padding:10,fontSize:12},children:U.errors.map((t,s)=>e.jsxs("li",{children:[t.file,": ",t.message]},s))})})]}):null,e.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:8},children:e.jsx("button",{type:"button",onClick:()=>G(t=>({...t,open:!1})),style:{padding:"6px 10px",border:"1px solid #ddd",borderRadius:6,background:"#fff",cursor:"pointer"},children:"Close"})})]})}):null,D.open?e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:60},onClick:()=>de({open:!1,requirementId:"",candidate:null}),children:e.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #eee",padding:14,width:"min(520px, 95vw)"},onClick:t=>t.stopPropagation(),children:[e.jsx("div",{style:{fontWeight:700,marginBottom:6},children:"Shortlisting"}),e.jsxs("div",{style:{fontSize:12,color:"#666",marginBottom:10},children:[Te(D.candidate)||((nt=D.candidate)==null?void 0:nt.candidateId)," (",(rt=D.candidate)==null?void 0:rt.candidateId,")"]}),e.jsx("div",{style:{fontSize:12,color:"#666",marginBottom:6},children:"Remark required for Reject/Hold"}),e.jsx("textarea",{rows:3,value:$e,onChange:t=>ye(t.target.value),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:6},placeholder:"Enter remark"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:()=>Re("OWNER_SEND"),disabled:P===`${D.requirementId}:${(at=D.candidate)==null?void 0:at.candidateId}:OWNER_SEND`||!d("SHORTLIST_DECIDE",["HR","ADMIN"])||!Ne("BTN_SHORTLIST_OWNER_SEND",["HR","ADMIN"]),style:{padding:"6px 10px",border:"1px solid #ddd",borderRadius:6,background:"#fff",cursor:"pointer"},children:"Owner Approval"}),e.jsx("button",{type:"button",onClick:()=>Re("HOLD"),disabled:P===`${D.requirementId}:${(it=D.candidate)==null?void 0:it.candidateId}:HOLD`||!d("SHORTLIST_DECIDE",["HR","ADMIN"]),style:{padding:"6px 10px",border:"1px solid #ddd",borderRadius:6,background:"#fff",cursor:"pointer"},children:"Hold"}),e.jsx("button",{type:"button",onClick:()=>Re("REJECT"),disabled:P===`${D.requirementId}:${(lt=D.candidate)==null?void 0:lt.candidateId}:REJECT`||!d("SHORTLIST_DECIDE",["HR","ADMIN"]),style:{padding:"6px 10px",border:"1px solid #ddd",borderRadius:6,background:"#fff",cursor:"pointer"},children:"Reject"}),e.jsx("button",{type:"button",onClick:()=>de({open:!1,requirementId:"",candidate:null}),style:{padding:"6px 10px",border:"1px solid #ddd",borderRadius:6,background:"#fff",cursor:"pointer"},children:"Close"})]})]})}):null]})}export{ws as HrReviewPage};
